# Koin Compiler Plugin Migration Plan

> Migrate from Koin KSP annotation processing to the Koin Kotlin Compiler Plugin (K2 native).

**Status:** Draft  
**Created:** 2026-02-28  
**Scope:** Demo/app modules only (composeApp, feature1, feature2)  
**Library modules (quo-vadis-core, quo-vadis-core-flow-mvi):** Not affected

---

## Table of Contents

- [Current State Summary](#current-state-summary)
- [Migration Target](#migration-target)
- [Phase 1: Kotlin Version Upgrade](#phase-1-kotlin-version-upgrade)
- [Phase 2: Version Catalog Changes](#phase-2-version-catalog-changes)
- [Phase 3: Build Configuration Changes](#phase-3-build-configuration-changes)
- [Phase 4: Source Code Changes](#phase-4-source-code-changes)
- [Phase 5: Documentation Updates](#phase-5-documentation-updates)
- [Phase 6: Verification](#phase-6-verification)
- [Risks & Considerations](#risks--considerations)
- [Rollback Strategy](#rollback-strategy)
- [Appendix: Quo Vadis KSP Coexistence](#appendix-quo-vadis-ksp-coexistence)

---

## Current State Summary

### Versions
| Dependency | Current Version |
|---|---|
| Kotlin | `2.2.21` |
| KSP | `2.3.4` |
| Compose Multiplatform | `1.11.0-alpha01` |
| Koin | `4.2.0-RC1` |
| Koin Annotations | `2.3.2-Beta1` (separate version) |

### Modules Using Koin KSP

| Module | KSP Plugin | Koin KSP Deps | Koin Annotations | Manual DSL Modules |
|---|---|---|---|---|
| **composeApp** | Yes (also quo-vadis) | ✅ 4 `add("ksp*", ...)` lines | ✅ `@Module`, `@ComponentScan` | ✅ `navigationModule`, `profileModule` |
| **feature1** | Yes (also quo-vadis) | ✅ 4 `add("ksp*", ...)` lines | ✅ `@Module`, `@ComponentScan`, `@Scoped`, `@Scope`, `@Qualifier` | — |
| **feature2** | Yes (quo-vadis only) | ❌ None | ❌ Not used | — |
| **quo-vadis-core-flow-mvi** | No | ❌ None | ❌ Core APIs only | — |

### Koin KSP Workaround Blocks (composeApp & feature1)

Both modules have two workaround blocks that exist **specifically for Koin KSP**:

```kotlin
// Block 1: KSP Common sourceSet
sourceSets.named("commonMain").configure {
    kotlin.srcDir("build/generated/ksp/metadata/commonMain/kotlin")
}

// Block 2: KSP task ordering (Koin per-platform KSP)
tasks.matching { it.name.startsWith("ksp") && it.name != "kspCommonMainKotlinMetadata" }
    .configureEach { dependsOn("kspCommonMainKotlinMetadata") }
```

**Key finding:** The quo-vadis gradle plugin (`QuoVadisPlugin.kt`) already handles equivalent configuration internally:
- It adds `kotlin.srcDir("build/generated/ksp/metadata/commonMain/kotlin")` to commonMain
- It sets up `dependsOn("kspCommonMainKotlinMetadata")` for compilation tasks

Therefore, both blocks are **safe to remove** when removing Koin KSP — the quo-vadis plugin covers its own KSP needs.

### KSP-Generated Imports (App.kt)

```kotlin
import org.koin.ksp.generated.com_jermey_feature1_resultdemo_Feature1Module
import org.koin.ksp.generated.com_jermey_navplayground_demo_ExploreModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_ProfileModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_StateDrivenDemoModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_TabsDemoModule
```

These extension properties are generated by KSP and used as Koin modules. With the compiler plugin, a `@KoinApplication` class replaces this manual wiring.

---

## Migration Target

- **Koin Compiler Plugin** (K2 native) replaces KSP-based annotation processing
- **Kotlin 2.3.x** required for the compiler plugin
- **Existing annotations unchanged** (`@Module`, `@ComponentScan`, `@Factory`, `@Scoped`, etc. are compatible)
- **`@KoinApplication` typed startup** replaces `koinConfiguration {}` + KSP-generated module imports
- **KSP plugin retained** for quo-vadis navigation KSP processor

---

## Phase 1: Kotlin Version Upgrade

> **Goal:** Update Kotlin to 2.3.x, ensuring all dependencies are compatible.

### 1.1 Determine Target Versions

Before starting, verify the latest compatible versions:

| Dependency | Action |
|---|---|
| Kotlin | Upgrade to `2.3.20` (or latest 2.3.x stable) |
| KSP | Update to match Kotlin 2.3.x (e.g. `2.3.20-1.0.x`) |
| Compose Multiplatform | Verify compatibility with Kotlin 2.3.x — may need alpha/beta update |
| AGP | Verify compatibility — current `8.13.2` should be fine |

**Action items:**
- [ ] Check [Kotlin releases](https://kotlinlang.org/docs/releases.html) for latest 2.3.x
- [ ] Check [KSP releases](https://github.com/google/ksp/releases) for matching KSP version
- [ ] Check [Compose Multiplatform compatibility](https://www.jetbrains.com/help/kotlin-multiplatform-dev/compose-compatibility-and-versioning.html) for Kotlin 2.3.x support
- [ ] Check Koin compiler plugin minimum version requirements

### 1.2 Update `gradle/libs.versions.toml`

```toml
[versions]
kotlin = "2.3.20"           # was 2.2.21
kotlinStdlib = "2.3.20"     # was 2.2.21 — keep in sync
ksp = "2.3.20-1.0.x"        # update to match Kotlin 2.3.x
# composeMultiplatform — update if needed for Kotlin 2.3.x compatibility
```

### 1.3 Verify Build

```bash
./gradlew clean build
```

**Expected issues:**
- API deprecations/removals between Kotlin 2.2 → 2.3
- Compose compiler compatibility (compose-compiler plugin version is tied to Kotlin version)
- KSP API changes (affects quo-vadis-ksp module)

**Resolve any issues before proceeding to Phase 2.**

---

## Phase 2: Version Catalog Changes

> **Goal:** Update `gradle/libs.versions.toml` for the Koin Compiler Plugin.

### 2.1 Add Koin Compiler Plugin Version

```toml
[versions]
koin = "4.2.0"                   # update to stable (or latest compatible)
koin-compiler-plugin = "2.3.2"   # Koin compiler plugin version (check latest)
# REMOVE: koin-annotations = "2.3.2-Beta1"  — annotations now use koin-compiler-plugin version
```

> **Note:** With the compiler plugin, `koin-annotations` version aligns with the compiler plugin version, not the separate `koin-annotations` version. Verify the exact version mapping from [Koin docs](https://insert-koin.io/docs/setup/annotations).

### 2.2 Update Libraries Section

```toml
[libraries]
# Keep unchanged:
koin-core = { module = "io.insert-koin:koin-core", version.ref = "koin" }
koin-compose = { module = "io.insert-koin:koin-compose", version.ref = "koin" }
koin-compose-viewmodel = { module = "io.insert-koin:koin-compose-viewmodel", version.ref = "koin" }
koin-test = { module = "io.insert-koin:koin-test", version.ref = "koin" }

# Update version ref:
koin-annotations = { module = "io.insert-koin:koin-annotations", version.ref = "koin-compiler-plugin" }

# REMOVE this line entirely:
# koin-ksp-compiler = { module = "io.insert-koin:koin-ksp-compiler", version.ref = "koin-annotations" }
```

### 2.3 Add Compiler Plugin Entry

```toml
[plugins]
# ADD:
koin-compiler = { id = "io.insert-koin.compiler.plugin", version.ref = "koin-compiler-plugin" }
```

### 2.4 Summary of Changes

| Entry | Action |
|---|---|
| `koin-annotations` version | Remove (use `koin-compiler-plugin` version) |
| `koin-compiler-plugin` version | **Add** |
| `koin-ksp-compiler` library | **Remove** |
| `koin-annotations` library | Update `version.ref` → `koin-compiler-plugin` |
| `koin-compiler` plugin | **Add** |
| `ksp` plugin | **Keep** (still needed for quo-vadis) |

---

## Phase 3: Build Configuration Changes

> **Goal:** Update `build.gradle.kts` files to use the compiler plugin instead of KSP for Koin.

### 3.1 `composeApp/build.gradle.kts`

#### Add Koin Compiler Plugin

```kotlin
plugins {
    // ... existing plugins ...
    alias(libs.plugins.ksp)            // KEEP — still needed for quo-vadis
    alias(libs.plugins.quoVadis)       // KEEP
    alias(libs.plugins.koin.compiler)  // ADD — Koin Compiler Plugin
}
```

#### Remove Koin KSP Dependencies

**Delete** the entire `// KSP Tasks` block (lines ~175-184):

```kotlin
// DELETE THIS ENTIRE BLOCK:
// KSP Tasks
dependencies {
    add("kspCommonMainMetadata", libs.koin.ksp.compiler)
    add("kspAndroid", libs.koin.ksp.compiler)
    add("kspIosArm64", libs.koin.ksp.compiler)
    add("kspIosSimulatorArm64", libs.koin.ksp.compiler)
}
```

#### Remove KSP Workaround Blocks

**Delete** both workaround blocks (safe because quo-vadis plugin handles its own):

```kotlin
// DELETE — quo-vadis plugin handles this internally:
// KSP Common sourceSet
sourceSets.named("commonMain").configure {
    kotlin.srcDir("build/generated/ksp/metadata/commonMain/kotlin")
}

// DELETE — only needed for Koin per-platform KSP tasks which are removed:
// Trigger Common Metadata Generation from Native tasks
tasks.matching { it.name.startsWith("ksp") && it.name != "kspCommonMainKotlinMetadata" }
    .configureEach {
        dependsOn("kspCommonMainKotlinMetadata")
    }
```

#### Keep Dependencies Unchanged

```kotlin
// These stay as-is in commonMain dependencies:
implementation(libs.koin.core)
api(libs.koin.annotations)
implementation(libs.koin.compose)
implementation(libs.koin.compose.viewmodel)
```

#### Optional: Add Compiler Plugin Configuration

```kotlin
// Optional — configure Koin compiler plugin options
koinCompiler {
    // Enable if needed:
    // generateDefaultModule = false  // disable auto-generation of default module
}
```

### 3.2 `feature1/build.gradle.kts`

**Same changes as composeApp:**

#### Add Koin Compiler Plugin

```kotlin
plugins {
    // ... existing plugins ...
    alias(libs.plugins.ksp)            // KEEP — still needed for quo-vadis
    alias(libs.plugins.quoVadis)       // KEEP
    alias(libs.plugins.koin.compiler)  // ADD
}
```

#### Remove Koin KSP Dependencies

**Delete** the `// KSP Tasks` block (lines ~165-174):

```kotlin
// DELETE THIS ENTIRE BLOCK:
// KSP Tasks
dependencies {
    add("kspCommonMainMetadata", libs.koin.ksp.compiler)
    add("kspAndroid", libs.koin.ksp.compiler)
    add("kspIosArm64", libs.koin.ksp.compiler)
    add("kspIosSimulatorArm64", libs.koin.ksp.compiler)
}
```

#### Remove KSP Workaround Blocks

**Delete** both blocks (same rationale as composeApp):

```kotlin
// DELETE:
sourceSets.named("commonMain").configure {
    kotlin.srcDir("build/generated/ksp/metadata/commonMain/kotlin")
}

// DELETE:
tasks.matching { it.name.startsWith("ksp") && it.name != "kspCommonMainKotlinMetadata" }
    .configureEach {
        dependsOn("kspCommonMainKotlinMetadata")
    }
```

### 3.3 `feature2/build.gradle.kts`

Feature2 has no Koin KSP dependencies and doesn't use annotations. **Minimal changes:**

- **Optionally** add `alias(libs.plugins.koin.compiler)` if annotations will be adopted in the future
- No KSP blocks to remove (it only uses KSP for quo-vadis)
- No annotation dependencies to update

**Recommendation:** Skip for now. Add the plugin when/if annotations are adopted in feature2.

### 3.4 `settings.gradle.kts`

**No changes needed.** The Koin compiler plugin resolves from `gradlePluginPortal()` which is already configured.

### 3.5 Summary of Build Changes

| File | Add Plugin | Remove KSP Deps | Remove Workaround Blocks |
|---|---|---|---|
| `composeApp/build.gradle.kts` | ✅ `koin.compiler` | ✅ 4 `add("ksp*", ...)` lines | ✅ Both blocks |
| `feature1/build.gradle.kts` | ✅ `koin.compiler` | ✅ 4 `add("ksp*", ...)` lines | ✅ Both blocks |
| `feature2/build.gradle.kts` | ❌ Skip | ❌ N/A | ❌ N/A |

---

## Phase 4: Source Code Changes

> **Goal:** Replace KSP-generated module wiring with `@KoinApplication` typed startup.

### 4.1 Create `@KoinApplication` Class

Create a new file in composeApp:

**File:** `composeApp/src/commonMain/kotlin/com/jermey/navplayground/NavPlaygroundKoinApp.kt`

```kotlin
package com.jermey.navplayground

import com.jermey.feature1.resultdemo.Feature1Module
import com.jermey.navplayground.demo.ExploreModule
import com.jermey.navplayground.demo.ProfileModule
import com.jermey.navplayground.demo.StateDrivenDemoModule
import com.jermey.navplayground.demo.TabsDemoModule
import org.koin.core.annotation.KoinApplication
import org.koin.core.annotation.Module

@KoinApplication
class NavPlaygroundKoinApp(
    // List all annotation-based modules
    val stateDrivenDemoModule: StateDrivenDemoModule,
    val tabsDemoModule: TabsDemoModule,
    val profileModule: ProfileModule,
    val exploreModule: ExploreModule,
    val feature1Module: Feature1Module,
)
```

> **Note:** The exact API for `@KoinApplication` may vary. Consult the [Koin compiler plugin docs](https://insert-koin.io/docs/reference/koin-annotations/start) for the correct syntax. The module listing may use constructor parameters, a `modules` annotation property, or another mechanism.
>
> **Alternative syntax** (if `@KoinApplication` takes a `modules` list):
> ```kotlin
> @KoinApplication(
>     modules = [
>         StateDrivenDemoModule::class,
>         TabsDemoModule::class,
>         ProfileModule::class,
>         ExploreModule::class,
>         Feature1Module::class,
>     ]
> )
> class NavPlaygroundKoinApp
> ```

### 4.2 Update `App.kt`

**File:** `composeApp/src/commonMain/kotlin/com/jermey/navplayground/App.kt`

#### Before

```kotlin
import org.koin.dsl.koinConfiguration
import org.koin.ksp.generated.com_jermey_feature1_resultdemo_Feature1Module
import org.koin.ksp.generated.com_jermey_navplayground_demo_ExploreModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_ProfileModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_StateDrivenDemoModule
import org.koin.ksp.generated.com_jermey_navplayground_demo_TabsDemoModule

@Composable
fun App() {
    val themeManager = rememberThemeManager()
    val themeMode by themeManager.themeMode.collectAsState()
    val koinConfiguration = koinConfiguration {
        modules(
            navigationModule,
            profileModule,
            com_jermey_navplayground_demo_ProfileModule,
            com_jermey_navplayground_demo_TabsDemoModule,
            com_jermey_navplayground_demo_StateDrivenDemoModule,
            com_jermey_navplayground_demo_ExploreModule,
            com_jermey_feature1_resultdemo_Feature1Module,
        )
    }
    KoinApplication(configuration = koinConfiguration) {
        NavPlaygroundTheme(themeMode = themeMode) {
            DemoApp()
        }
    }
}
```

#### After

```kotlin
// REMOVE these imports:
// import org.koin.dsl.koinConfiguration
// import org.koin.ksp.generated.*

// ADD:
import org.koin.core.annotation.KoinApplication

@Composable
fun App() {
    val themeManager = rememberThemeManager()
    val themeMode by themeManager.themeMode.collectAsState()
    val koinConfiguration = koinConfiguration<NavPlaygroundKoinApp> {
        // Manual DSL modules still included here:
        modules(
            navigationModule,
            profileModule,
        )
    }
    KoinApplication(configuration = koinConfiguration) {
        NavPlaygroundTheme(themeMode = themeMode) {
            DemoApp()
        }
    }
}
```

> **Key change:** The typed `koinConfiguration<NavPlaygroundKoinApp>` automatically includes all modules listed in the `@KoinApplication` class. Only the manual DSL modules (`navigationModule`, `profileModule`) need to be listed explicitly.
>
> **Verify:** The exact API for `koinConfiguration<T>` may differ. Check Koin compiler plugin docs for:
> - How `@KoinApplication` integrates with `KoinApplication` composable
> - Whether manual DSL modules can be mixed with `@KoinApplication` modules
> - Whether a different startup function is needed (e.g. `startKoin<MyApp>()`)

### 4.3 Annotations — No Changes Needed

All existing annotations are compatible with the compiler plugin:

| Annotation | Location | Status |
|---|---|---|
| `@Module` + `@ComponentScan` | `composeApp/.../demo/DI.kt` | ✅ Compatible |
| `@Module` + `@ComponentScan` | `feature1/.../resultdemo/Di.kt` | ✅ Compatible |
| `@Factory` | Various screens | ✅ Compatible |
| `@Scoped` + `@Scope` + `@Qualifier` | Container classes | ✅ Compatible |

### 4.4 `koinInject` — No Changes Needed

Composable injection via `koinInject<T>()` in feature2 and other screens is unaffected.

---

## Phase 5: Documentation Updates

> **Goal:** Update docs that reference KSP.

### 5.1 `docs/FLOWMVI-KOIN.md`

Two lines reference "Koin KSP":

**Line 76** — Update:
```markdown
# Before:
> **Note:** For Koin Annotations support (alternative to DSL registration), ensure you're using Koin 4.1+ and have configured the Koin KSP processor.

# After:
> **Note:** For Koin Annotations support (alternative to DSL registration), ensure you're using Koin 4.1+ and have configured the Koin Compiler Plugin.
```

**Line 578** — Update:
```markdown
# Before:
As an alternative to the manual DSL registration, you can use **Koin Annotations** for compile-time dependency resolution. This approach requires **Koin 4.1+** and the Koin KSP annotation processor.

# After:
As an alternative to the manual DSL registration, you can use **Koin Annotations** for compile-time dependency resolution. This approach requires **Koin 4.1+** and the Koin Compiler Plugin.
```

### 5.2 Other Documentation

Check for any other KSP references related to Koin:
- `README.md` — Verify no Koin KSP setup instructions
- `.github/copilot-instructions.md` — No Koin KSP references (only mentions `koin` generically)

---

## Phase 6: Verification

> **Goal:** Confirm the migration works across all platforms.

### 6.1 Clean Build

```bash
# Remove old KSP-generated Koin code
rm -rf composeApp/build/generated/ksp
rm -rf feature1/build/generated/ksp
# Note: quo-vadis KSP output will be regenerated automatically

./gradlew clean build
```

### 6.2 Run Tests

```bash
./gradlew test
```

### 6.3 Platform Verification

| Platform | Command | Verify |
|---|---|---|
| Desktop | `./gradlew :composeApp:run` | App launches, all DI resolves |
| Android | `./gradlew :composeApp:installDebug` | App launches, all screens work |
| iOS | Xcode build + run | App launches, all screens work |
| JS Web | `./gradlew :composeApp:jsBrowserDevelopmentRun` | App loads in browser |
| WASM Web | `./gradlew :composeApp:wasmJsBrowserDevelopmentRun` | App loads in browser |

### 6.4 Verification Checklist

- [ ] Clean build succeeds with no errors
- [ ] All existing tests pass
- [ ] Desktop app launches and all screens work
- [ ] Android app launches and all screens work
- [ ] DI-scoped containers resolve correctly (`@Scoped` in feature1)
- [ ] `koinInject` works in feature2 screens
- [ ] Manual DSL modules (`navigationModule`, `profileModule`) still work
- [ ] No `org.koin.ksp.generated` references remain in source code
- [ ] No `koin-ksp-compiler` references remain in build files
- [ ] Detekt passes: `./gradlew detekt`

---

## Risks & Considerations

### High Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **Kotlin 2.3.x compatibility** | Compose Multiplatform or other dependencies may not support 2.3.x yet | Check compatibility matrix before starting. May need to wait for Compose Multiplatform release. |
| **Koin Compiler Plugin maturity** | Plugin may have bugs or incomplete KMP support | Test thoroughly on all platforms. Keep ability to rollback. |
| **`@KoinApplication` API uncertainty** | Exact syntax for typed startup may differ from examples | Consult latest Koin docs. The API may use `startKoin<T>()` or similar. |

### Medium Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **Mixed manual + annotation modules** | `navigationModule` and `profileModule` are manual DSL. Mixing with `@KoinApplication` typed API needs verification. | Test that manual `modules(...)` works alongside `@KoinApplication` |
| **Scoped injection (`@Scoped`)** | Scoped containers in feature1 may behave differently with compiler plugin | Test ResultDemoContainer and ItemPickerContainer specifically |
| **KSP version bump** | Changing KSP version for Kotlin 2.3.x may affect quo-vadis KSP processor | Build and test quo-vadis KSP separately after version bump |

### Low Risk

| Risk | Impact | Mitigation |
|---|---|---|
| **Residual generated code** | Old KSP-generated files in `build/` may conflict | Clean build directories before first build |
| **IDE indexing** | IntelliJ/Android Studio may not immediately recognize compiler plugin output | Invalidate caches / restart if needed |

---

## Rollback Strategy

If the migration fails or introduces critical issues:

1. **Revert version catalog** (`gradle/libs.versions.toml`) to previous state
2. **Revert build files** (`composeApp/build.gradle.kts`, `feature1/build.gradle.kts`)
3. **Revert source changes** (`App.kt`, delete `NavPlaygroundKoinApp.kt`)
4. **Revert Kotlin version** back to `2.2.21`
5. **Clean and rebuild:** `./gradlew clean build`

**Recommendation:** Create a git branch for the migration and keep the main branch clean until verification is complete.

```bash
git checkout -b feature/koin-compiler-plugin-migration
```

---

## Appendix: Quo Vadis KSP Coexistence

### Why KSP Plugin Stays

The `com.google.devtools.ksp` plugin is used by the quo-vadis navigation library's KSP processor. It is **completely independent** from Koin's annotation processing and must remain:

- **Plugin:** `alias(libs.plugins.ksp)` — **Keep** in all modules using quo-vadis
- **Plugin:** `alias(libs.plugins.quoVadis)` — **Keep** — configures quo-vadis KSP internally
- **Version catalog entry:** `ksp` version and plugin — **Keep**

### What the Quo-Vadis Plugin Handles

The `QuoVadisPlugin` (`quo-vadis-gradle-plugin/src/.../QuoVadisPlugin.kt`) internally:

1. Adds `kspCommonMainMetadata` dependency for the quo-vadis KSP processor
2. Configures `kotlin.srcDir("build/generated/ksp/metadata/commonMain/kotlin")` on commonMain
3. Sets up `dependsOn("kspCommonMainKotlinMetadata")` for compilation tasks
4. Passes KSP arguments (`quoVadis.modulePrefix`)

This is why the duplicate blocks in `composeApp/build.gradle.kts` and `feature1/build.gradle.kts` are safe to remove — they were only needed as additional workarounds for Koin's per-platform KSP tasks (`kspAndroid`, `kspIosArm64`, etc.), which the compiler plugin eliminates.

### Coexistence Summary

| Concern | Status |
|---|---|
| KSP plugin removal | ❌ Cannot remove — needed for quo-vadis |
| KSP version in catalog | ✅ Keep and update for Kotlin 2.3.x |
| `sourceSets.named("commonMain")` block | ✅ Remove — quo-vadis plugin handles it |
| `tasks.matching` KSP ordering block | ✅ Remove — was for Koin per-platform KSP only |
| Koin KSP `add("ksp*", ...)` deps | ✅ Remove — replaced by compiler plugin |
| `koin-ksp-compiler` in version catalog | ✅ Remove |

---

## Change Summary by File

| File | Changes |
|---|---|
| `gradle/libs.versions.toml` | Add `koin-compiler-plugin` version, add `koin-compiler` plugin, remove `koin-annotations` version, remove `koin-ksp-compiler` library, update `koin-annotations` version ref |
| `composeApp/build.gradle.kts` | Add `koin.compiler` plugin, remove 4 `add("ksp*", ...)` lines, remove `sourceSets.named("commonMain")` block, remove `tasks.matching` block |
| `feature1/build.gradle.kts` | Add `koin.compiler` plugin, remove 4 `add("ksp*", ...)` lines, remove `sourceSets.named("commonMain")` block, remove `tasks.matching` block |
| `feature2/build.gradle.kts` | No changes (optionally add plugin later) |
| `composeApp/.../App.kt` | Remove KSP-generated imports, use typed `koinConfiguration<NavPlaygroundKoinApp>`, keep manual DSL modules |
| `composeApp/.../NavPlaygroundKoinApp.kt` | **New file** — `@KoinApplication` class listing all annotation-based modules |
| `docs/FLOWMVI-KOIN.md` | Update 2 lines referencing "Koin KSP" → "Koin Compiler Plugin" |
